<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5.1 is lots of fun by jaron dembsky</title>
    <!-- MathJax for rendering beautiful math -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Canvas Confetti for celebrations -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #6366f1;
            --secondary: #a855f7;
            --accent: #ec4899;
            --background: #0f172a;
            --card-bg: #1e293b;
            --text: #f8fafc;
            --success: #22c55e;
            --error: #ef4444;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, var(--background), #1e1b4b);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            overflow-x: hidden;
        }

        .container {
            width: 90%;
            max-width: 600px;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: float 3s ease-in-out infinite;
        }

        .subtitle {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .score-pill {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.1);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .category-tag {
            position: absolute;
            top: 15px;
            left: 15px;
            color: var(--accent);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-box {
            font-size: 1.8rem;
            margin: 2rem 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 1.5rem;
        }

        button.option-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            color: var(--text);
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button.option-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        button.option-btn:active {
            transform: scale(0.98);
        }

        button.option-btn.correct {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        button.option-btn.wrong {
            background: var(--error);
            border-color: var(--error);
            animation: shake 0.5s;
        }

        .next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 2rem;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }

        .next-btn.show {
            opacity: 1;
            pointer-events: all;
        }

        .next-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @media (max-width: 500px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>5.1 is lots of fun</h1>
    <div class="subtitle">by jaron dembsky</div>

    <div class="card">
        <div class="category-tag" id="category-tag">Topic</div>
        <div class="score-pill">Streak: <span id="streak">0</span></div>

        <div class="question-box fade-in" id="question-area">
            Loading...
        </div>

        <div class="options-grid" id="options-area">
            <!-- Options injected here -->
        </div>

        <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Problem âž”</button>
    </div>
</div>

<script>
    /* 
       LOGIC ENGINE 
       Based on the PDF provided:
       1. Reciprocal & Quotient Identities
       2. Pythagorean Identities
       3. Co-Function & Even/Odd Identities
       4. Simplifying Expressions
       5. Factoring/Expanding
    */

    let currentStreak = 0;
    let currentCorrectIndex = 0;
    let isAnswered = false;

    // Variables used for randomization to make infinite variations
    const variables = ["x", "\\theta", "t", "\\alpha", "\\beta"];

    const problems = [
        // --- 1. RECIPROCAL & QUOTIENT ---
        {
            type: "Reciprocal Identities",
            gen: (v) => ({ q: `\\csc(${v})`, a: `\\frac{1}{\\sin(${v})}` }),
            distractors: (v) => [`\\frac{1}{\\cos(${v})}`, `\\sin(${v})`, `\\sec(${v})`]
        },
        {
            type: "Reciprocal Identities",
            gen: (v) => ({ q: `\\frac{1}{\\sec(${v})}`, a: `\\cos(${v})` }),
            distractors: (v) => [`\\sin(${v})`, `\\csc(${v})`, `\\sec(${v})`]
        },
        {
            type: "Quotient Identities",
            gen: (v) => ({ q: `\\tan(${v})`, a: `\\frac{\\sin(${v})}{\\cos(${v})}` }),
            distractors: (v) => [`\\frac{\\cos(${v})}{\\sin(${v})}`, `\\frac{1}{\\sin(${v})}`, `\\sin(${v})`]
        },
        {
            type: "Quotient Identities",
            gen: (v) => ({ q: `\\cot(${v})`, a: `\\frac{\\cos(${v})}{\\sin(${v})}` }),
            distractors: (v) => [`\\frac{\\sin(${v})}{\\cos(${v})}`, `\\frac{1}{\\cos(${v})}`, `\\cos(${v})`]
        },

        // --- 2. PYTHAGOREAN IDENTITIES ---
        {
            type: "Pythagorean Identities",
            gen: (v) => ({ q: `\\sin^2(${v}) + \\cos^2(${v})`, a: `1` }),
            distractors: (v) => [`0`, `2`, `\\tan^2(${v})`]
        },
        {
            type: "Pythagorean Identities",
            gen: (v) => ({ q: `1 - \\cos^2(${v})`, a: `\\sin^2(${v})` }),
            distractors: (v) => [`\\cos^2(${v})`, `-\\sin^2(${v})`, `\\csc^2(${v})`]
        },
        {
            type: "Pythagorean Identities",
            gen: (v) => ({ q: `\\sec^2(${v}) - 1`, a: `\\tan^2(${v})` }),
            distractors: (v) => [`\\cot^2(${v})`, `1`, `\\csc^2(${v})`]
        },
        {
            type: "Pythagorean Identities",
            gen: (v) => ({ q: `1 + \\cot^2(${v})`, a: `\\csc^2(${v})` }),
            distractors: (v) => [`\\sec^2(${v})`, `\\tan^2(${v})`, `1`]
        },

        // --- 3. EVEN/ODD & CO-FUNCTION ---
        {
            type: "Even/Odd Identities",
            gen: (v) => ({ q: `\\sin(-${v})`, a: `-\\sin(${v})` }),
            distractors: (v) => [`\\sin(${v})`, `\\cos(${v})`, `-\\cos(${v})`]
        },
        {
            type: "Even/Odd Identities",
            gen: (v) => ({ q: `\\cos(-${v})`, a: `\\cos(${v})` }),
            distractors: (v) => [`-\\cos(${v})`, `\\sin(${v})`, `-\\sin(${v})`]
        },
        {
            type: "Co-Function Identities",
            gen: (v) => ({ q: `\\sin\\left(\\frac{\\pi}{2} - ${v}\\right)`, a: `\\cos(${v})` }),
            distractors: (v) => [`\\sin(${v})`, `-\\cos(${v})`, `\\csc(${v})`]
        },
        {
            type: "Co-Function Identities",
            gen: (v) => ({ q: `\\tan\\left(\\frac{\\pi}{2} - ${v}\\right)`, a: `\\cot(${v})` }),
            distractors: (v) => [`-\\tan(${v})`, `\\tan(${v})`, `\\sec(${v})`]
        },

        // --- 4. SIMPLIFYING EXPRESSIONS (Based on PDF Pages 3-4) ---
        {
            type: "Simplifying Expressions",
            gen: (v) => ({ q: `\\sin(${v}) \\cdot \\csc(${v})`, a: `1` }),
            distractors: (v) => [`0`, `\\sin^2(${v})`, `\\cos(${v})`]
        },
        {
            type: "Simplifying Expressions",
            gen: (v) => ({ q: `\\tan(${v}) \\cdot \\cos(${v})`, a: `\\sin(${v})` }),
            distractors: (v) => [`\\cos(${v})`, `1`, `\\csc(${v})`]
        },
        {
            type: "Simplifying Expressions",
            gen: (v) => ({ q: `\\cos(${v}) \\cdot \\sec(${v}) - \\sin^2(${v})`, a: `\\cos^2(${v})` }),
            distractors: (v) => [`\\sin^2(${v})`, `1`, `0`]
        },
        {
            type: "Simplifying Expressions",
            gen: (v) => ({ q: `\\frac{\\sin(${v})}{\\tan(${v})}`, a: `\\cos(${v})` }),
            distractors: (v) => [`\\sin(${v})`, `\\sec(${v})`, `1`]
        },
        {
            type: "Simplifying Expressions",
            gen: (v) => ({ q: `\\frac{1 - \\cos^2(${v})}{\\sin(${v})}`, a: `\\sin(${v})` }),
            distractors: (v) => [`\\cos(${v})`, `\\csc(${v})`, `1`]
        },

        // --- 5. FACTORING & EXPANDING (Based on PDF Page 5) ---
        {
            type: "Factoring / Expanding",
            gen: (v) => ({ q: `(1 - \\sin(${v}))(1 + \\sin(${v}))`, a: `\\cos^2(${v})` }),
            distractors: (v) => [`\\sin^2(${v})`, `1`, `1 - \\sin(${v})`]
        },
        {
            type: "Factoring / Expanding",
            gen: (v) => ({ q: `(\\sec(${v}) - 1)(\\sec(${v}) + 1)`, a: `\\tan^2(${v})` }),
            distractors: (v) => [`\\sec^2(${v})`, `1`, `\\cot^2(${v})`]
        },
        {
            type: "Factoring / Expanding",
            gen: (v) => ({ q: `\\sin^4(${v}) - \\cos^4(${v})`, a: `\\sin^2(${v}) - \\cos^2(${v})` }),
            distractors: (v) => [`1`, `(\\sin(${v})-\\cos(${v}))^2`, `0`]
        }
    ];

    function getRandomElement(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function generateQuestion() {
        isAnswered = false;
        document.getElementById('next-btn').classList.remove('show');
        const varChoice = getRandomElement(variables);
        const template = getRandomElement(problems);
        
        // Generate Question and Answer
        const qa = template.gen(varChoice);
        const dists = template.distractors(varChoice);
        
        // Update UI
        document.getElementById('category-tag').innerText = template.type;
        document.getElementById('question-area').innerHTML = `\\[ ${qa.q} \\]`;
        
        // Prepare Options
        let options = [
            { latex: qa.a, isCorrect: true },
            { latex: dists[0], isCorrect: false },
            { latex: dists[1], isCorrect: false },
            { latex: dists[2], isCorrect: false }
        ];

        shuffleArray(options);

        // Find where the correct answer ended up
        currentCorrectIndex = options.findIndex(o => o.isCorrect);

        // Render Buttons
        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = '';
        
        options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = `\\( ${opt.latex} \\)`;
            btn.onclick = () => checkAnswer(btn, opt.isCorrect);
            optionsArea.appendChild(btn);
        });

        // Re-render MathJax
        MathJax.typeset();
        
        // Reset Animation
        const qBox = document.getElementById('question-area');
        qBox.classList.remove('fade-in');
        void qBox.offsetWidth; // trigger reflow
        qBox.classList.add('fade-in');
    }

    function checkAnswer(btn, isCorrect) {
        if (isAnswered) return; // Prevent multiple guesses per question
        isAnswered = true;

        const buttons = document.querySelectorAll('.option-btn');

        if (isCorrect) {
            btn.classList.add('correct');
            currentStreak++;
            triggerConfetti();
        } else {
            btn.classList.add('wrong');
            currentStreak = 0;
            // Highlight the correct one
            buttons.forEach(b => {
                // We need to re-verify which button holds the correct answer visually, 
                // but since we randomized, let's just loop through logic
                // A simple hack: we know the correct answer is styled green.
            });
            
            // Find correct button to show user
            buttons.forEach(b => {
                 // Check inner HTML content or data attribute? 
                 // Easier: pass the index or mark it during generation.
                 // Let's just re-evaluate logic for simplicity:
                 // Actually, we can just find the one that didn't get clicked?
                 // No, let's just mark the correct one green regardless.
            });
            
            // Highlight the correct answer for learning
            // We need to find the button with isCorrect = true logic.
            // Since we didn't store it on the element, let's just iterate and match text or modify generation.
            // IMPROVEMENT: Let's do it in the generation loop.
        }

        // Highlight the correct one always (for feedback)
        const allButtons = document.querySelectorAll('.option-btn');
        allButtons.forEach(b => {
           // We need to check if this button corresponds to the correct answer.
           // Since we randomized, we can't rely on index.
           // Let's rely on the click handler closure? No.
           // Let's brute force match the content for now or add a data attribute.
        });
        
        // Simpler approach: Add data-correct to the button in generation
        // Let's patch the generate function logic briefly here via the DOM:
        // (See updated generateQuestion logic below implicitly handled if I added data-attr, 
        // but for now let's just show the next button)

        document.getElementById('streak').innerText = currentStreak;
        document.getElementById('next-btn').classList.add('show');
    }

    // Overwrite generateQuestion slightly to add data attribute for easier grading
    // Rerunning logic to ensure robustness
    function generateQuestionv2() {
        isAnswered = false;
        document.getElementById('next-btn').classList.remove('show');
        const varChoice = getRandomElement(variables);
        const template = getRandomElement(problems);
        
        const qa = template.gen(varChoice);
        const dists = template.distractors(varChoice);
        
        document.getElementById('category-tag').innerText = template.type;
        document.getElementById('question-area').innerHTML = `\\[ ${qa.q} \\]`;
        
        let options = [
            { latex: qa.a, isCorrect: true },
            { latex: dists[0], isCorrect: false },
            { latex: dists[1], isCorrect: false },
            { latex: dists[2], isCorrect: false }
        ];

        shuffleArray(options);

        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = '';
        
        options.forEach((opt) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.dataset.correct = opt.isCorrect; // Store truthiness
            btn.innerHTML = `\\( ${opt.latex} \\)`;
            btn.onclick = () => handleAnswer(btn);
            optionsArea.appendChild(btn);
        });

        MathJax.typeset();
        
        const qBox = document.getElementById('question-area');
        qBox.classList.remove('fade-in');
        void qBox.offsetWidth; 
        qBox.classList.add('fade-in');
    }

    function handleAnswer(btn) {
        if (isAnswered) return;
        isAnswered = true;
        const isCorrect = btn.dataset.correct === "true";

        if (isCorrect) {
            btn.classList.add('correct');
            currentStreak++;
            triggerConfetti();
        } else {
            btn.classList.add('wrong');
            currentStreak = 0;
            // Highlight the actual correct one
            document.querySelectorAll('.option-btn').forEach(b => {
                if(b.dataset.correct === "true") b.classList.add('correct');
            });
        }
        document.getElementById('streak').innerText = currentStreak;
        document.getElementById('next-btn').classList.add('show');
    }

    function nextQuestion() {
        generateQuestionv2();
    }

    function triggerConfetti() {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#6366f1', '#a855f7', '#ec4899']
        });
    }

    // Init
    window.onload = generateQuestionv2;

</script>
</body>
</html>
